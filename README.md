## docker의 정의
- https://www.redhat.com/ko/topics/containers/what-is-docker

## docker cli 명령어

### docker build

Dockerfile을 기준으로 이미지를 빌드하는 작업. 일반적으로 태그를 부여하는 옵션인 -t와 함께 많이 사용된다.

- -t, --tag: 빌드된 이미지에 태그를 지정. 이미지이름:태그 형식으로 사용.
- -f, --file: 사용할 도커파일의 경로를 지정다. 기본값은 ./Dockerfile
- -q, --quiet: 빌드 진행 상황 메시지를 출력하지 않음
- --build-arg: 도커파일 내에서 ARG 지시문에 전달할 빌드 인자를 지정.

### docker push

이미지나 리포지토리를 토커 레지스트리에 업로드하는 과정을 의미한다.

### docker inspect

이미지에 태그를 생성하는 명령어이다. **docker tag 원본이미지:태그 변경할\_이미지:태그** 형태로 실행한다. 한가지 유념할점은 이름을 수정하는게 아니라 기존 이미지에 새로운 태그를 붙인다는 것이다.

### docker run

이미지를 기반으로 새로운 컨테이너를 생성하는 명령어다. 웹 애플리케이션을 실행하는 이미지를 만들었다면 이 명령어를 통해 컨테이너를 만들어 웹 애플리케이션을 컨테이너 내부에서 작동하게끔 할 수 있다.

### docker ps

현재 가동 중인 컨테이너 목록을 확인할 수 있는 명령어다.

### docker rm

컨테이너를 삭제할 수 있다. 실행 중인 컨테이너를 삭제하려면 docker stop {이미지명}으로 해당 컨테이너를 중지시키고 삭제해야 한다.

## Dockerfile

### CMD

- CMD 명령어는 컨테이너가 시작될 때 기본적으로 실행할 명령어를 지정
- 하지만, **docker run** 명령을 실행할 때 컨테이너 실행과 관련된 추가 인자를 제공하면, 해당 인자가 CMD로 지정한 명령어를 덮어쓴다
- 컨테이너 실행 시 실행할 기본 명령어를 설정하는 데 사용되며, 일반적으로 애플리케이션의 진입점을 지정하는 용도로 활용
- 명령어를 배열 형태로 지정할 수 있음

### FROM

- 베이스가 되는 이미지를 지정하는 명령어.

### ENV

- 이미지내에 환경변수를 설정하는 명령어.

### CMD

- ENTRYPOINT처럼 배열의 형태로 명령어를 담아 실행시킨다는 특징이 있음
- CMD가 Dockerfile안에 여러개가 있다면, 그 여러개중 하나만 실행된다는 특징이 있음.

### RUN

- 도커의 층단위로 명령어를 쌓아가는 용고로 활용된다.

### ENTRYPOINT

- ENTRYPOINT 명령어는 컨테이너가 시작될 때 항상 실행할 명령어를 지정
- docker run 명령을 통해 컨테이너를 실행할 때 추가 인자로 덮어쓸 수 없음.
- 추가 인자는 ENTRYPOINT로 지정한 명령어의 인자로 전달.
- 일반적으로 애플리케이션의 핵심 실행 파일 또는 실행 가능한 스크립트를 지정하는 데 사용
- CMD와 달리 ENTRYPOINT는 배열 형태로 지정하지 않으면 기본 셸에 의해 실행

### EXPOSE

- docker 컨테이너의 특정포트를 외부에 오픈하는 설정이다.

### WORKDIR

- 이미지내에 특정폴더로 이동하기위해서 사용함.

## docker-compose

- 여러 개의 Docker 컨테이너들을 하나의 서비스로 정의하고 구성해 하나의 묶음으로 관리할 수 있게 해준다.

### 컨테이너 실행

- docker-compose up -d // 도커 백그라운드 실행
- docker-compose up --force-recreate // 도커 컨테이너 새로 만들기
- docker-compose up --build // 도커 이미지 빌드 후 compose up

### 컨테이너 내리기

- docker-compose down // 컨테이너 stop & 삭제
- docker-compose stop

## 진짜 실행해보자

### 삽질의 시작

- window에서 예제코드를 실행해보니까 제대로 실행이 안되는 이슈가 있었습니다.
- COPY ./nginx/nginx.conf /etc/nginx/nginx.conf에서 /nginx/nginx.conf를 못찾는 문제였습니다.
- 저는 이때 OS차이로 인해 발생한것은 아닐까 싶어서 linux환경을 조성해봤습니다.
- WSL을 설치하고 docker를 실행하도록 만들었으나 똑같이 실행이 안됐네요.
- 그래서 뭐가 문제일까 싶어서 경로설정이 틀렸는지 자료조사를 해봤지만 그 문제는 아니였습니다.
- 잘 생각해보니 ./nginx/nginx.conf를 루트 경로에 생성하지 않아서 생긴 문제는 아닐까 싶었습니다.
- nginx.conf를 직접 찾아낸다음 루트경로에 파일을 생성해봤습니다.
- 빌드도 되고 실행도 되긴하는데 localhost:3000에 접속이 안됐습니다.
- 결국 "책에있는 예제대로 하지말고 걍 내가 직접 찾아서 해보자!"라는 결론이 났으며 아래 방법으로 실행하니까 잘 됐네요!
- https://velog.io/@bebop0303/local%EC%97%90%EC%84%9C-vite-nginx%EB%A5%BC-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A1%9C-%EB%A7%8C%EB%93%A4%EC%96%B4-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0
- 이게 이렇게까지 오래걸릴 문제였을까 싶었지만 그래도 Docker 명령어에 익숙해졌으며 vite에서 도커 설정을 어떻게 해야하는지도 생각해보는 시간이 돼서 유익했습니다.

### 도커를 올려보자

도커로 만든 이미지를 클라우드 환경에서 실행해보자.\
먼저 도커 허브라고 하는 공간에 도커 이미지를 업로드 해야한다.\
도커 허브는 도커 데스크톱을 통해 사용가능.
